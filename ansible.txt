===========================
Node server pre req
netplan apply (se precisar reaplicar o DHCP)

sudo su
passwd
vi /etc/ssh/sshd_config (PermitRootLogin yes)
service sshd restart

*se precisar setar IP e Hostname
echo ubuntu-<nome> > /etc/hostname
hostname -F /etc/hostname

nano /etc/default/grub
  GRUB_CMDLINE_LINUX="net.ifnames=0 biosdevname=0"

grub-mkconfig -o /boot/grub/grub.cfg

vi etc/netplan/00-installer-config.yaml
-----
network:
  ethernets:
    eth0:
      addresses:
      - 192.168.1.x/24
      gateway4: 192.168.1.1
      nameservers:
        addresses:
        - 192.168.1.1
        search:
        - uz.local
  version: 2
-----
reboot
netplan apply (nao funcionaria pois alteramos o nome da NIC no GRUB)

*Worker nodes for GlusterFS
cfdisk /dev/sdb (or vdb)
mkfs -t ext4 /dev/sdb1 (or vdb1)
mkdir /gfs
mkdir /gfs/infra
mount /dev/sdb1 /gfs/infra

make entry into /etc/fstab, so it mounts on reboot
/dev/sdb1       /gfs/infra   ext4    defaults,nofail


============================
Source script server pre req
apt install ansible
ssh-keygen
ssh-copy-id root@<node_ip>
============================
Source script server
mkdir ~/kube-cluster
cd ~/kube-cluster

nano ~/kube-cluster/hosts (alterar IPs)

ansible-playbook -i hosts ~/kube-cluster/main/initial.yml
ansible-playbook -i hosts ~/kube-cluster/kubernetes/kube-dependencies.yml
ansible-playbook -i hosts ~/kube-cluster/kubernetes/master.yml

ssh ubuntu@master_ip
kubectl get nodes

ansible-playbook -i hosts ~/kube-cluster/kubernetes/workers.yml

ssh ubuntu@master_ip
kubectl get nodes

ansible-playbook -i hosts ~/kube-cluster/gluster/glusterfs.yml

--------------------
Know issues:
Zabbix nao consegue enviar msg para Slack: Precisa alterar o dominio do script da media de slack.com para slack.com. (isso ocorre por conta do ndots:5 inserido nos resolv.conf)
